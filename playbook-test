---
- hosts: dev
  gather_facts: no
  tasks:
    - name: Install Java
      shell: yum install java-1.8.0-openjdk -y
      ignore_errors: yes
      become: true
      
    - name: Install Git
      shell: sudo apt-get install git-core -y
      ignore_errors: yes
      become: true
      
    - name:    Install prerequisites
      apt:     name={{item}} update_cache=yes
      with_items:
        - apt-transport-https
        - ca-certificates
        - curl
        - software-properties-common
    - name:    Add Docker GPG key
        apt_key: url=https://download.docker.com/linux/ubuntu/gpg
    - name:    Add Docker APT repository
        apt_repository:
        repo: deb [arch=amd64] https://download.docker.com/linux/ubuntu {{ansible_distribution_release}} stable
    - name:    Install Docker
        apt:   name=docker-ce
    - name: Installing packages
       package:
         name: "{{ packages }}"
         state: present
         vars:
       packages:
         - openssl
         - python-openssl
    - name: Creating certs dir
       import_tasks: create_dir.yml
        vars:
        item: "{{ openssl_certs_path }}"
        mode: "0755"

    - name: Creating keys dir
       import_tasks: create_dir.yml
        vars:
         item: "{{ openssl_keys_path }}"
         mode: "0700"

    - name: Creating csrs dir
       when: openssl_generate_csr
       import_tasks: create_dir.yml
       vars:
       item: "{{ openssl_csrs_path }}"
       mode: "0750"
